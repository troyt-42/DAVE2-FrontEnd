!function(){"use strict";function e(e,t,a){var o=this;o.loading=!0;var l=angular.element("#container");a.on("importersInfo",function(e){console.log(e)}),a.on("importersData",function(e){l.highcharts("StockChart",{chart:{zoomType:"x",type:"areaspline"},title:{text:"Data Item 58-B9-E1-F1-87-89"},tooltip:{pointFormat:' | <span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b>',positioner:function(){return{x:10,y:100}},crosshairs:{dashStyle:"dash",color:"orange"}},plotOptions:{series:{tooltip:{dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L"}},marker:{states:{hover:{fillColor:"orange"}}},animation:!1,states:{hover:!1}}},xAxis:{type:"datetime",dateTimeLabelFormats:{day:"%e  %b %Y",month:"%b"},events:{afterSetExtremes:function(){l.highcharts().showLoading("Loading data from server..."),a.emit("displayRquest",{min:this.min,max:this.max})}},minRange:6048e5},navigator:{adaptToUpdatedData:!1,series:{data:e}},scrollbar:{liveRedraw:!1},rangeSelector:{enabled:!0,allButtonsEnabled:!0,buttons:[{type:"day",count:3,text:"3d"},{type:"week",count:1,text:"1w"},{type:"month",count:1,text:"1m"},{type:"month",count:6,text:"6m"},{type:"year",count:1,text:"1y"},{type:"all",text:"All"}],selected:2},series:[{name:"Data Point",data:e}]});var t=[],n=[];console.log(e.slice(0,100));for(var s=new Date(e[0][0]),i=new Date(e[e.length-1][0]),m=i.getFullYear(),r=s.getFullYear(),d=m-r,c=r;m>c;c++){t.push({id:"id_"+c,name:"Data of "+c,value:12,max:4321.241,min:1932.49,average:3284.531,dataLabels:{enabled:!0,format:'<span style="; text-shadow:none">Complete Data of<br><span style=";color:red;text-shadow:none">'+c+"</span></span>",verticalAlign:"middle"}});for(var u=1;4>=u;u++)t.push({id:"id_"+c+"_"+u,parent:"id_"+c,name:"Data of "+c+" "+u,value:1})}console.log(t.length);for(var p=r;m>p;p++)n.push([Date.UTC(p,0,0,0),12]);angular.element("#container2").highcharts("StockChart",{chart:{animation:!0},tooltip:{pointFormat:'<span style="color:{series.color};font-weight:bold">{point.name}</span><br>| <b>Max: </b>{point.max}<br>| <b>Min: </b>{point.min}<br>| <b>Average: </b>{point.average}',borderColor:"#3A8AD3",borderRadius:5},rangeSelector:{buttons:[{type:"millisecond",count:100/d*1,text:"1 item"},{type:"millisecond",count:100/d*2,text:"2 item"},{type:"millisecond",count:100/d*4,text:"4 items"},{type:"millisecond",count:100/d*8,text:"8 items"},{type:"millisecond",count:100/d*10,text:"10 items"}],selected:4},navigator:{enabled:!1,adaptToUpdatedData:!1,xAxis:{floor:0,ceiling:100,dateTimeLabelFormats:{millisecond:"%L",day:"%L"}}},xAxis:{events:{afterSetExtremes:function(){console.log(this)}}},plotOptions:{series:{dataGrouping:{enabled:!1}},treemap:{states:{hover:{enabled:!1}}}},series:[{type:"treemap",layoutAlgorithm:"stripes",allowDrillToNode:!0,dataLabels:{enabled:!1},levelIsConstant:!1,levels:[{level:1,dataLabels:{enabled:!0,style:{fontSize:"1.3em"}},borderWidth:3,borderColor:"white",color:"black"},{level:2,borderColor:"#3A8AD3"}],data:t}],subtitle:{text:"Data Table"},title:{text:"58-B9-E1-F1-87-89"}});for(var I=[],g=0;100>g;g++){var b=new Date(e[g][0]);I.push([b.toUTCString(),e[g][1]])}o.tableData=I,o.loading=!1}),a.on("displayResponse",function(e){console.log(e),l.highcharts().series[0].setData(e),l.highcharts().hideLoading();for(var t=[],a=0;100>a;a++){var n=new Date(e[a][0]);t.push([n.toUTCString(),e[a][1]])}o.tableData=t})}function t(e,t,a,o,l,n,s,i){function m(){if(o.remove("dataItemListTableColumns"),void 0===o.getObject("dataItemListTableColumns")&&o.putObject("dataItemListTableColumns",D.dataItemListTableColumns),D.dataItemListTableColumns=o.getObject("dataItemListTableColumns"),D.avaliableDataItemTableColumns=o.getObject("avaliableDataItemTableColumns")||[],l.emit("requestDataItemList"),D.promiseToSolve=t(function(){for(var e=!1,t=0;t<D.alerts.length;t++)"Loading Importer List Failed. Please Check Your Internet Connection."===D.alerts[t].msg&&(e=!0);e||D.alerts.push({type:"danger",msg:"Loading Importer List Failed. Please Check Your Internet Connection."}),D.systemStatus="Error"},5e3),s.writeState("hasMenu",!1),D.options=e.options?JSON.parse(e.options):{},console.log(D.options),0!==D.options.length)for(var a in D.options)D[a]=D.options[a],console.log(D[a])}function r(e,t){0!==D.avaliableDataItemTableColumns.length&&(D.dataItemListTableColumns[e.index-1].status=!0,D.avaliableDataItemTableColumns.splice(t,1),o.putObject("dataItemListTableColumns",D.dataItemListTableColumns),o.putObject("avaliableDataItemTableColumns",D.avaliableDataItemTableColumns))}function d(e,t,a){if(console.log(t),13===e.keyCode)if(t.index===t.newIndex)D.addTableColumn(t,a);else{t.newIndex>D.dataItemListTableColumns.length&&(t.newIndex=D.dataItemListTableColumns.length),t.newIndex<1&&(t.newIndex=1),D.dataItemListTableColumns[t.index-1].index=t.newIndex-1,D.dataItemListTableColumns[t.newIndex-1].index=t.index-1;var l=D.dataItemListTableColumns[t.index-1];D.dataItemListTableColumns[t.index-1]=D.dataItemListTableColumns[t.newIndex-1],D.dataItemListTableColumns[t.newIndex-1]=l,t.index=t.newIndex,console.log(t),console.log(D.avaliableDataItemTableColumns),console.log(D.dataItemListTableColumns),D.addTableColumn(t,a)}o.putObject("dataItemListTableColumns",D.dataItemListTableColumns),o.putObject("avaliableDataItemTableColumns",D.avaliableDataItemTableColumns)}function c(e){angular.element("div.alert.animated#dataItemList"+e).removeClass("fadeInDown"),angular.element("div.alert.animated#dataItemList"+e).addClass("fadeOutUp"),D.alerts.splice(e,1)}function u(e){for(var t=e-1;t>=0;t--)if(D.dataItemListTableColumns[t].status){var a=D.dataItemListTableColumns[e];a.index=t,D.dataItemListTableColumns[t].index=e,D.dataItemListTableColumns[e]=D.dataItemListTableColumns[t],D.dataItemListTableColumns[t]=a;break}}function p(e){for(var t=e+1;t<D.dataItemListTableColumns.length;t++)if(D.dataItemListTableColumns[t].status){var a=D.dataItemListTableColumns[e];a.index=t,D.dataItemListTableColumns[t].index=e,D.dataItemListTableColumns[e]=D.dataItemListTableColumns[t],D.dataItemListTableColumns[t]=a;break}}function I(e){D.dataItemListTableColumns[e].status=!1,D.avaliableDataItemTableColumns.push({index:e+1,value:D.dataItemListTableColumns[e].name,newIndex:e+1}),console.log(D.avaliableDataItemTableColumns),o.putObject("dataItemListTableColumns",D.dataItemListTableColumns),o.putObject("avaliableDataItemTableColumns",D.avaliableDataItemTableColumns)}function g(t){if(i.recordToDoItems([t]),0===angular.element("dave-data-item-display-page").length){var o=e.$parent.$new(!0);o.dataItemsToRequest=[t],n.DestroyDirectiveService("dave-data-item-display-list-page",e),n.AddDirectiveService(".dataItemDisplayContainer",'<dave-data-item-display-page class="angular-directive" dave-data-items="{{dataItemsToRequest}}"></dave-data-item-display-page>',o,a)}}function b(){angular.element(".js-layout").toggleClass("hidden")}function v(){n.EnterSearchMode("dave-data-item-display-list-page","<dave-data-item-display-list-page></dave-data-item-display-list-page>",".dataItemDisplayContainer",e,a)}var D=this;D.activate=m,D.addTableColumn=r,D.addTableColumnKeyPress=d,D.closeAlert=c,D.decreaseColumnIndex=u,D.increaseColumnIndex=p,D.removeColumn=I,D.requestDataItem=g,D.toggleLayOutMenu=b,D.toggleSearchMode=v,D.alerts=[],D.avaliableDataItemTableColumns=[],D.dataItemList=[],D.dataItemListCurrentPage=1,D.dataItemListTableColumns=[{name:"name",status:!0,index:0},{name:"location",status:!0,index:1},{name:"note",status:!0,index:2},{name:"precision",status:!0,index:3},{name:"unit",status:!0,index:4}],D.disableSetUpButton=!1,D.promiseToSolve="",D.search={},D.systemStatus="Normal",D.loading=!0,e.$on("socket:ipDataItemListResponse",function(e,a){console.log(e.name),"Normal"===D.systemStatus&&(t.cancel(D.promiseToSolve),1!==a.completeState?D.dataItemList=D.dataItemList.concat(a.list_out):(D.dataItemList=D.dataItemList.concat(a.list_out),D.loading=!1))}),D.activate()}function a(e,t,a,o,l,n,s,i,m){function r(){b.dataItemsToRequest=m.readToDoItems();for(var e=0;e<b.dataItemsToRequest.length;e++)n.emit("requestDataItem",b.dataItemsToRequest[e]),b.dataItemsData[b.dataItemsToRequest[e].name]=[],m.clearToDoItems(b.dataItemsToRequest[e]),console.log(b.dataItemsToRequest)}function d(){var e=l.open({templateUrl:"DataItemDisplay/DataItemModalViews/addDataItem.html",controller:"AddDataItemModalCtrl as addDataItemModalCtrl",size:"lg",resolve:{currentDataItems:function(){return b.dataItemsToRequest}}});e.result.then(function(e){console.log(e)})}function c(){var t=e.$parent.$new(!0);s.DestroyDirectiveService("dave-data-item-display-page",e),s.AddDirectiveService(".dataItemDisplayContainer",'<dave-data-item-display-list-page  class="angular-directive"></dave-data-item-display-list-page>',t,a),m.clearDataItems()}function u(e){angular.element("div.alert.animated#dataItem"+e).removeClass("fadeInDown"),angular.element("div.alert.animated#dataItem"+e).addClass("fadeOutUp"),b.alerts.splice(e,1)}function p(){v.highcharts().series[0].setData([])}function I(e){var t=l.open({templateUrl:"DataItemDisplay/DataItemModalViews/dataItemSetting.html",controller:"DataItemSettingModalCtrl as dataItemSettingModalCtrl",resolve:{currentDataItem:function(){return b.dataItemsToRequest[e]}}});t.result.then(function(e){console.log(e)})}function g(){s.EnterSearchMode("dave-data-item-display-page","<dave-data-item-display-page></dave-data-item-display-page>",".dataItemDisplayContainer",e,a)}var b=this;b.activate=r,b.addDataItem=d,b.backToDataItemList=c,b.closeAlert=u,b.removeData=p,b.openSettingModal=I,b.toggleSearchMode=g,b.alerts=[],b.completeState=0,b.dataItemsData=[],b.dataItemsToRequest=m.readToDoItems(),b.loading=!0,b.systemStatus="Normal",b.waitingMessage="Loading Data From Server";var v=angular.element("#container");e.$on("socket:ipDataItemResponse",function(e,t){if(console.log(t),"ERROR"===t.reply){b.loading=!1;for(var a=!1,o=0;o<b.alerts.length;o++)"Loading Data Item Failed. Please Check Your Internet Connection."===b.alerts[o].msg&&(a=!0);a||b.alerts.push({type:"danger",msg:"Loading Data Item Failed. Please Check Your Internet Connection."}),b.systemStatus="Error"}else if(console.log(t.payload.name),t.completeState)if(1!==t.completeState)100*t.completeState-b.completeState>5&&(b.completeState=100*t.completeState),b.dataItemsData[t.payload.name]=b.dataItemsData[t.payload.name].concat(t.list_out);else if(b.completeState=100*t.completeState,b.dataItemsData[t.payload.name]=b.dataItemsData[t.payload.name].concat(t.list_out),console.log(b.dataItemsData[t.payload.name].length),console.log("First Value: "+b.dataItemsData[t.payload.name][0]),console.log("Last Value: "+b.dataItemsData[t.payload.name][b.dataItemsData[t.payload.name].length-1]),b.loading=!1,void 0===v.highcharts()){var l={chart:{zoomType:"x",type:"spline"},title:{text:b.dataItemsToRequest[0].name},tooltip:{pointFormat:' | <span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b>',positioner:function(){return{x:0,y:0}},crosshairs:{color:"black"}},plotOptions:{series:{tooltip:{dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L"}},marker:{states:{hover:{}}},animation:!0,states:{hover:!1},lineWidth:1}},xAxis:{type:"datetime",dateTimeLabelFormats:{day:"%e  %b %Y",month:"%b"},events:{afterSetExtremes:function(){}},minRange:1e4},navigator:{},scrollbar:{liveRedraw:!1},rangeSelector:{enabled:!0,buttonTheme:{fill:"orange",stroke:"none","stroke-width":0,r:8,style:{color:"#000",fontWeight:"bold"},states:{hover:{},select:{fill:"black",style:{color:"white"}}}},buttons:[{type:"second",count:30,text:"30s"},{type:"minute",count:1,text:"1m"},{type:"minute",count:30,text:"30m"},{type:"hour",count:1,text:"1h"},{type:"hour",count:3,text:"3h"},{type:"all",text:"All"}],selected:2},series:[{name:t.payload.name,data:b.dataItemsData[t.payload.name]}]};v.highcharts("StockChart",l)}else v.highcharts().addSeries({name:t.payload.name,data:b.dataItemsData[t.payload.name]});else if(t.list_out)for(var n=0;n<t.list_out.length;n++)v.highcharts().series[0].addPoint(t.list_out[n],!0,!0)}),e.$on("socket:ipAsychLoadingDataResponse",function(e,t){console.log(e.name),v.highcharts().series[0].setData(t),v.highcharts().hideLoading()}),e.$on("$destroy",function(){n.emit("stopDataItemConnection")}),e.$watch(function(){return m.readToDoItems()},function(e,t){console.log(e),b.dataItemsToRequest=m.readfinishedItems().concat(e);for(var a=0;a<e.length;a++)n.emit("requestDataItem",e[a]),b.dataItemsData[e[a].name]=[],m.clearToDoItems(e[a])},!0),b.activate()}function o(e,t,a,o){function l(){console.log(a)}function n(){console.log("called"),t.dismiss("cancel")}var s=this;s.activate=l,s.cancel=n,s.activate()}function l(e,t,a,o){function l(){}function n(){console.log("called"),t.dismiss("cancel")}var s=this;s.activate=l,s.cancel=n}angular.module("Dave2.DataItemDisplay").controller("DataItemDisplayCtrl",e).controller("DaveDataItemDisplayListPageCtrl",t).controller("DaveDataItemDisplayPageCtrl",a).controller("AddDataItemModalCtrl",o).controller("DataItemSettingModalCtrl",l),e.$inject=["$scope","$timeout","DataItemDisplaySocket"],t.$inject=["$scope","$timeout","$compile","$cookies","DataItemDisplaySocket","DirectiveService","generalStateWRS","DataItemDisplayRegistryService"],a.$inject=["$scope","$timeout","$compile","$cookies","$modal","DataItemDisplaySocket","DirectiveService","generalStateWRS","DataItemDisplayRegistryService"],o.$inject=["$scope","$modalInstance","currentDataItems","DataItemDisplaySocket"],l.$inject=["$scope","$modalInstance","currentDataItem","DataItemDisplaySocket"]}();